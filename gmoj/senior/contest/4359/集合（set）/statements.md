# 集合（set）

## 题目描述

小 L 有m个集合S₁...Sₘ，保证所有集合的并集为1-n，两两集合的交集为空。

小 L 要做若干次操作，操作种类如下：

1. x,y，将数 x所在的集合改为y。
2. k l₁ r₁...lₖ rₖ，令T=[l₁,r₁] ∪[l₂,r₂] ∪...[lₖ,rₖ]，如果满足我们手中的这m个集合中的任意一个集合Si和集合T取交集之后的元素个数都为c的倍数（c已经提前给出），那么输出1，否则输出0。换而言之，如果∀1≤i≤m，|Si ∩T|≡0（mod c），那么输出1，否则输出0。

这里定义|A|表示A集合的元素个数，同时保证c为质数。小 L 不会做，于是他便向你求助。

## 输入

第一行三个数n,m,c。

第二行n个数a₁...aₙ，其中ai表示第i个数初始属于哪一个集合。

接下来一个数q,表示操作次数。

接下来q行，每行读入一个数op，表示操作种类。

如果op=1，那么再读入两个数，x,y。

如果op=2，则读入k以及l₁ r₁ l₂ r₂ ...lₖ rₖ，保证∀1≤i＜k，rᵢ＜lᵢ₊₁。

## 输出

对于每一个询问，一行，输出0或1，输出1表示满足条件，输出0表示不满足条件。

## 样例数据

### 样例输入 1

```
3 2 2
1 2 1
4
2 1 1 3
2 2 1 1 3 3
1 1 2
2 1 1 2

```

### 样例输出 1

```
0
1
1

```


## 数据范围限制

| 数据编号 | n≤     | m≤  | 特殊性质              |
| -------- | ------- | ---- | --------------------- |
| 1，2     | 100     | 100  | 无                    |
| 3，4     | 10⁵    | 50   | 无                    |
| 5，6，7  | 10⁵    | 5000 | 所有的k=1，无修改操作 |
| 8，9，10 | 3×10⁵ | 5000 | 所有的k=1             |
| 11-14    | 10⁵    | 5000 | Σk,q≤10⁵           |
| 15-20    | 3×10⁵ | 5000 | 无                    |

保证1＜n,q≤3×10⁵，1＜Σk≤4×10⁵，c≤10³，注意有些部分分内并没有规定q和ΣK的大小。

## 提示

【样例解释】

初始 S₁={1，3}，S₂={2}。

第一次询问中T=[1,3]，虽然|S₁∩T|=2，但是|S₂∩T|=1，不是2的倍数，所以输出0。

第二次询问中T=[1,1]∪[3,3]，这时|S₁∩T|=2，|S₂∩T|=0均满足条件，所以输出1。

接着将1所属的集合修改成2，此时S₁={3}，S₂={1，2}。

第三次询问中T=[1,2]，此时|S₁∩T|=0，|S₂∩T|=2均满足条件，所以输出1。
