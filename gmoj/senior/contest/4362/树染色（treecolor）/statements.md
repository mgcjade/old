# 树染色（treecolor）

## 题目描述

小 T 有一个 $n$ 个点的有根树，根为 $1$ 号点，树上每条边有两个权值 $a_i$, $b_i$。

粗略地说，小 T 想给树上每条边都染上黑色或白色，为此，小 T 每次会选择一条从祖先到儿子的链和一种颜色，并将这条链上未染色的边染上这种颜色。

小 T 还希望他选择的每一条链，都与之前的某条链经过的点的交集非空，特别地，第一条链必须从根出发。

最后，小 T 希望选的链尽量少，并在这个基础上计算所有方案的美观度之和。

具体来说，对于 $m$ 个点对 $(u_1, v_1), (u_2, v_2), \ldots, (u_m, v_m)$，若满足以下条件则称这 $m$ 个点对是合法的。

- 对任意 $1 \leq i \leq m$，都有 $u_i \neq v_i$ 且 $u_i$ 是 $v_i$ 的祖先；
- $u_1 = 1$，且对任意 $2 \leq i \leq m$，都存在正整数 $j < i$，满足从 $u_i$ 到 $v_i$ 的路径和从 $u_j$ 到 $v_j$ 的路径都经过了至少一个相同的**点**，换句话说，路径 $(u_i, v_i)$ 与路径 $(u_j, v_j)$ 经过的点的交集非空；
- 对树上的每条边 $e$，都存在 $1 \leq i \leq m$，使得从 $u_i$ 到 $v_i$ 的路径经过 $e$。

对于点对 $(u_i, v_i)$，小 T 需要选定一种颜色 $c_i \in \set{0, 1}$，分别表示黑色或白色。

所有合法点对与点对的颜色统称为一种**方案**，两种方案不同当且仅当 $m$ 不同、或者某个有序对 $(u_i, v_i)$ 不同、或者某个 $c_i$ 不同。

对于一条边 $e$，若**第一次**经过 $e$ 的路径 $(u_i, v_i)$ 对应的颜色为黑色，则定义边 $e$ 的美观度为 $a_i$，否则若为白色，则定义美观度为 $b_i$。

定义一棵树的美观度为所有边的美观度的乘积。小 T 想知道，在**最小化** $m$ 的前提下，所有方案中树的美观度之和为多少。答案对 $998244353$ 取模。

## 输入

第一行一个整数 $n$，表示树的点数。

接下来 $n-1$ 行，每行四个整数 $x_i, y_i, a_i, b_i$，表示一条树边 $(x_i, y_i)$ 以及它的两个权值。

## 输出

输出一行一个整数表示答案对 $998244353$ 取模的结果。

## 样例数据

### 样例输入 1

```
5
1 2 2 1
1 3 1 2
2 4 0 1
2 5 1 1

```

### 样例输出 1

```
90

```


## 数据范围限制

对于所有测试点：$2 \leq n \leq 5 \times 10^5$，$1 \leq x_i, y_i \leq n$，$0 \leq a_i, b_i < 998244353$，保证给出的边构成了一棵树。

每个测试点的具体限制见下表：


|  测试点编号  |    $n \leq$    |    特殊限制    |
| :----------: | :-------------: | :-------------: |
|  $1 \sim 3$  |       $7$       |       无       |
|  $4 \sim 7$  | $5 \times 10^5$ |        A        |
| $8 \sim 11$ | $5 \times 10^5$ |        B        |
| $12 \sim 16$ | $5 \times 10^5$ | $a_i = b_i = 1$ |
| $17 \sim 20$ | $5 \times 10^5$ |       无       |

特殊限制 A：保证树上度数为 $1$ 的点数 $\leq 10$。

特殊限制 B：保证树上每个点的深度 $\leq 2$，换句话说，每个点到根的最短路最多经过 $2$ 条边。

## 提示

**【样例 1 解释】**

最小的 $m$ 是 $3$，共有 $96$ 种方案，例如，选择点对 $(1,5), (1,3), (2,4)$，对应颜色分别为 $0,1,1$ 时，美观度为 $2 \times 2 \times 1 \times 1=4$，若选择点对相同，但对应颜色为 $0,1,0$ 时，美观度则变为 $2 \times 2 \times 0 \times 1=0$。
